<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="./css/test.css?v=001">
</head>

<body>
    <div class="container js-container">
        <div class="wrapper">
            <div class="thumbnail fakePin">1</div>
            <div class="thumbnail fakePin">2</div>
            <div class="thumbnail fakePin">3</div>
            <div class="thumbnail fakePin">4</div>
            <div class="thumbnail fakePin">5</div>
        </div>
    </div>

    <div class="container js-container">
        <div class="wrapper">
            <div class="thumbnail fakePin">6</div>
            <div class="thumbnail fakePin">7</div>
            <div class="thumbnail fakePin">8</div>
            <div class="thumbnail fakePin">9</div>
            <div class="thumbnail fakePin">10</div>
        </div>
    </div>

    <footer>
        <div class="scrollbar"></div>
    </footer>
</body>

<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

<script>
    gsap.registerPlugin(ScrollTrigger);

    //const scrubValue = true;
    const scrubValue = 0.5;
    let containers = document.querySelectorAll('.js-container')


    containers.forEach((container, index) => {
        console.log(container.scrollWidth)
        let t = ScrollTrigger.create({
            trigger: container,
            start: `top top`,
            end: () => ((container.scrollWidth * (index + 1)) - window.innerWidth),
            pin: true,
            anticipatePin: 1,
            scrub: scrubValue,
            invalidateOnRefresh: true,
            //markers: index === 1
        })



        let thumbNails = gsap.utils.toArray(container.querySelectorAll(".thumbnail"));
        thumbNails.forEach((thumb, i) => {
            gsap.to(thumb, {
                x: () => {
                    return - (i * window.innerWidth)
                },
                ease: "none",
                scrollTrigger: {
                    trigger: thumb.closest(".wrapper"),
                    start: 'top top',
                    scrub: scrubValue,
                    invalidateOnRefresh: true,
                    end: () => "+=" + (i * window.innerWidth),
                    // markers: true
                }
            });
        });
    })


    // function prevAll(container, i) {
    //     let element = container.querySelectorAll('.thumbnail')[i];
    //     var result = [];
    //
    //     while (element = element.previousElementSibling)
    //         result.push(element);
    //
    //     return result;
    // }




    // function getTotalWidthToMove(container, indexThumb) {
    //     totalWidthToMove = 0;
    //     let previous = prevAll(container, indexThumb);
    //
    //     previous.forEach(thumbBefore => {
    //         let style = thumbBefore.currentStyle || window.getComputedStyle(thumbBefore);
    //         let marginRight = parseInt(style.marginRight);
    //         totalWidthToMove += thumbBefore.offsetWidth + marginRight;
    //     });
    //
    //     return totalWidthToMove;
    // }

</script>

</html>